import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { useMemo } from 'react';
import { Check, AlertTriangle, FileText, FolderTree, ChevronDown, Download, Package } from 'lucide-react';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Collapsible, CollapsibleContent, CollapsibleTrigger } from '@/components/ui/collapsible';
import { AppLayout } from '@/components/AppLayout';
import { loadProductData, hasExportZip, getExportZipUrl } from '@/lib/product-loader';
import { getAllSectionIds, getSectionScreenDesigns } from '@/lib/section-loader';
export function ExportPage() {
    const productData = useMemo(() => loadProductData(), []);
    // Get section stats
    const sectionStats = useMemo(() => {
        const allSectionIds = getAllSectionIds();
        const sectionCount = productData.roadmap?.sections.length || 0;
        const sectionsWithScreenDesigns = allSectionIds.filter(id => {
            const screenDesigns = getSectionScreenDesigns(id);
            return screenDesigns.length > 0;
        }).length;
        return { sectionCount, sectionsWithScreenDesigns, allSectionIds };
    }, [productData.roadmap]);
    const hasOverview = !!productData.overview;
    const hasRoadmap = !!productData.roadmap;
    const hasDataModel = !!productData.dataModel;
    const hasDesignSystem = !!productData.designSystem;
    const hasShell = !!productData.shell;
    const hasSections = sectionStats.sectionsWithScreenDesigns > 0;
    const requiredComplete = hasOverview && hasRoadmap && hasSections;
    // Check for export zip
    const exportZipAvailable = hasExportZip();
    const exportZipUrl = getExportZipUrl();
    return (_jsx(AppLayout, { children: _jsxs("div", { className: "space-y-6", children: [_jsxs("div", { className: "mb-8", children: [_jsx("h1", { className: "text-2xl font-semibold text-stone-900 dark:text-stone-100 mb-2", children: exportZipAvailable ? 'Ready for implementation!' : 'Export' }), _jsx("p", { className: "text-stone-600 dark:text-stone-400", children: exportZipAvailable
                                ? 'Download your product design package and implement it in your codebase using the provided handoff prompts and assets.'
                                : 'Generate a complete handoff package for your development team.' })] }), !exportZipAvailable && (_jsxs(Card, { className: "border-stone-200 dark:border-stone-700 shadow-sm", children: [_jsx(CardHeader, { children: _jsx(CardTitle, { className: "text-lg font-semibold text-stone-900 dark:text-stone-100 flex items-center gap-2", children: requiredComplete ? (_jsxs(_Fragment, { children: [_jsx("div", { className: "w-6 h-6 rounded-full bg-lime-100 dark:bg-lime-900/30 flex items-center justify-center", children: _jsx(Check, { className: "w-4 h-4 text-lime-600 dark:text-lime-400", strokeWidth: 2.5 }) }), "Ready to Export"] })) : (_jsxs(_Fragment, { children: [_jsx("div", { className: "w-6 h-6 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center", children: _jsx(AlertTriangle, { className: "w-4 h-4 text-amber-600 dark:text-amber-400", strokeWidth: 2.5 }) }), "Not Ready"] })) }) }), _jsx(CardContent, { children: _jsxs("div", { className: "space-y-1", children: [_jsx(ChecklistItem, { label: "Product Overview", isComplete: hasOverview }), _jsx(ChecklistItem, { label: "Product Roadmap", isComplete: hasRoadmap }), _jsx(ChecklistItem, { label: "Data Model", isComplete: hasDataModel }), _jsx(ChecklistItem, { label: "Design System", isComplete: hasDesignSystem }), _jsx(ChecklistItem, { label: "Application Shell", isComplete: hasShell }), _jsx(ChecklistItem, { label: `Sections with screen designs (${sectionStats.sectionsWithScreenDesigns}/${sectionStats.sectionCount})`, isComplete: hasSections })] }) })] })), requiredComplete && (_jsxs(Card, { className: "border-stone-200 dark:border-stone-700 shadow-sm", children: [_jsx(CardHeader, { children: _jsx(CardTitle, { className: "text-lg font-semibold text-stone-900 dark:text-stone-100 flex items-center gap-2", children: exportZipAvailable ? (_jsxs(_Fragment, { children: [_jsx("div", { className: "w-6 h-6 rounded-full bg-lime-100 dark:bg-lime-900/30 flex items-center justify-center", children: _jsx(Check, { className: "w-4 h-4 text-lime-600 dark:text-lime-400", strokeWidth: 2.5 }) }), "Export Package is Ready"] })) : ('Generate Export Package') }) }), _jsxs(CardContent, { className: "space-y-6", children: [exportZipAvailable && exportZipUrl ? (_jsxs("div", { className: "space-y-4", children: [_jsxs("div", { className: "flex items-center gap-3 p-4 bg-lime-50 dark:bg-lime-900/20 rounded-lg border border-lime-200 dark:border-lime-800", children: [_jsx("div", { className: "w-10 h-10 rounded-full bg-lime-100 dark:bg-lime-900/40 flex items-center justify-center shrink-0", children: _jsx(Package, { className: "w-5 h-5 text-lime-600 dark:text-lime-400", strokeWidth: 1.5 }) }), _jsxs("div", { className: "flex-1 min-w-0", children: [_jsx("p", { className: "font-medium text-stone-900 dark:text-stone-100", children: "Download & use in your codebase" }), _jsx("p", { className: "text-sm text-stone-500 dark:text-stone-400", children: "product-plan.zip" })] }), _jsxs("a", { href: exportZipUrl, download: "product-plan.zip", className: "inline-flex items-center gap-2 px-4 py-2 bg-lime-600 hover:bg-lime-700 text-white font-medium text-sm rounded-md transition-colors shrink-0", children: [_jsx(Download, { className: "w-4 h-4", strokeWidth: 2 }), "Download"] })] }), _jsxs("p", { className: "text-sm text-stone-500 dark:text-stone-400", children: ["To regenerate, run ", _jsx("code", { className: "font-mono text-stone-700 dark:text-stone-300", children: "/export-product" }), " again."] })] })) : (_jsxs("div", { className: "space-y-4", children: [_jsx("p", { className: "text-stone-600 dark:text-stone-400", children: "Run the following command to generate a complete export package with all components, types, and handoff documentation:" }), _jsx("div", { className: "bg-stone-100 dark:bg-stone-800 rounded-md px-4 py-3", children: _jsx("code", { className: "text-sm font-mono text-stone-800 dark:text-stone-200", children: "/export-product" }) })] })), _jsxs("div", { className: "pt-4 border-t border-stone-200 dark:border-stone-700", children: [_jsxs("h4", { className: "text-sm font-medium text-stone-500 dark:text-stone-400 uppercase tracking-wide mb-4 flex items-center gap-2", children: [_jsx(FolderTree, { className: "w-4 h-4", strokeWidth: 1.5 }), "What's Included"] }), _jsxs("div", { className: "grid sm:grid-cols-2 gap-4", children: [_jsx(ExportItem, { title: "Ready-to-Use Prompts", description: "Pre-written prompts to copy/paste into your coding agent.", items: ['one-shot-prompt.md', 'section-prompt.md'] }), _jsx(ExportItem, { title: "Instructions", description: "Detailed implementation guides for your coding agent.", items: ['product-overview.md', 'one-shot-instructions.md', 'incremental/ (milestones)'] }), _jsx(ExportItem, { title: "Design System", description: "Colors, typography, and styling configuration for consistent branding.", items: ['CSS tokens', 'Tailwind config', 'Font setup'] }), _jsx(ExportItem, { title: "Data Model", description: "Entity definitions and sample data for your application.", items: ['TypeScript types', 'Sample data', 'Entity docs'] }), _jsx(ExportItem, { title: "Components", description: "React components and visual references for each section.", items: ['Shell components', 'Section components', 'Screenshots'] }), _jsx(ExportItem, { title: "Test Instructions", description: "Framework-agnostic test specs for TDD implementation.", items: ['tests.md per section', 'User flow tests', 'Empty state tests'] })] })] })] })] })), _jsxs(Card, { className: "border-stone-200 dark:border-stone-700 shadow-sm", children: [_jsx(CardHeader, { children: _jsxs(CardTitle, { className: "text-lg font-semibold text-stone-900 dark:text-stone-100 flex items-center gap-2", children: [_jsx(FileText, { className: "w-5 h-5 text-stone-500 dark:text-stone-400", strokeWidth: 1.5 }), "How to Use the Export"] }) }), _jsxs(CardContent, { className: "space-y-4", children: [_jsxs(Collapsible, { children: [_jsxs(CollapsibleTrigger, { className: "flex items-start justify-between w-full text-left group", children: [_jsxs("div", { className: "flex-1", children: [_jsx("h4", { className: "font-medium text-stone-900 dark:text-stone-100", children: "Option A: Incremental (Recommended)" }), _jsx("p", { className: "text-sm text-stone-500 dark:text-stone-400 mt-1", children: "Build milestone by milestone for better control and easier debugging." })] }), _jsx(ChevronDown, { className: "w-4 h-4 text-stone-400 dark:text-stone-500 mt-1 shrink-0 transition-transform group-data-[state=open]:rotate-180", strokeWidth: 1.5 })] }), _jsx(CollapsibleContent, { children: _jsxs("ol", { className: "text-sm text-stone-600 dark:text-stone-400 space-y-2 list-decimal list-inside mt-4 pl-1", children: [_jsxs("li", { children: ["Copy the ", _jsx("code", { className: "font-mono text-stone-800 dark:text-stone-200", children: "product-plan/" }), " folder into your codebase"] }), _jsxs("li", { children: ["Start with Foundation (", _jsx("code", { className: "font-mono text-stone-800 dark:text-stone-200", children: "instructions/incremental/01-foundation.md" }), ")"] }), _jsxs("li", { children: ["Then Shell (", _jsx("code", { className: "font-mono text-stone-800 dark:text-stone-200", children: "instructions/incremental/02-shell.md" }), ")"] }), _jsxs("li", { children: ["For each section:", _jsxs("ul", { className: "mt-1.5 ml-5 space-y-1", children: [_jsxs("li", { className: "flex items-center gap-2", children: [_jsx("span", { className: "w-1 h-1 rounded-full bg-stone-400 dark:bg-stone-500" }), "Open ", _jsx("code", { className: "font-mono text-stone-800 dark:text-stone-200", children: "prompts/section-prompt.md" })] }), _jsxs("li", { className: "flex items-center gap-2", children: [_jsx("span", { className: "w-1 h-1 rounded-full bg-stone-400 dark:bg-stone-500" }), "Fill in the section variables at the top (SECTION_NAME, SECTION_ID, NN)"] }), _jsxs("li", { className: "flex items-center gap-2", children: [_jsx("span", { className: "w-1 h-1 rounded-full bg-stone-400 dark:bg-stone-500" }), "Copy/paste the prompt into your AI coding agent"] })] })] }), _jsx("li", { children: "Review and test after each milestone before moving to the next" })] }) })] }), _jsx("div", { className: "border-t border-stone-200 dark:border-stone-700" }), _jsxs(Collapsible, { children: [_jsxs(CollapsibleTrigger, { className: "flex items-start justify-between w-full text-left group", children: [_jsxs("div", { className: "flex-1", children: [_jsx("h4", { className: "font-medium text-stone-900 dark:text-stone-100", children: "Option B: One-Shot" }), _jsx("p", { className: "text-sm text-stone-500 dark:text-stone-400 mt-1", children: "Build the entire app in one session using a pre-written prompt." })] }), _jsx(ChevronDown, { className: "w-4 h-4 text-stone-400 dark:text-stone-500 mt-1 shrink-0 transition-transform group-data-[state=open]:rotate-180", strokeWidth: 1.5 })] }), _jsx(CollapsibleContent, { children: _jsxs("ol", { className: "text-sm text-stone-600 dark:text-stone-400 space-y-2 list-decimal list-inside mt-4 pl-1", children: [_jsxs("li", { children: ["Copy the ", _jsx("code", { className: "font-mono text-stone-800 dark:text-stone-200", children: "product-plan/" }), " folder into your codebase"] }), _jsxs("li", { children: ["Open ", _jsx("code", { className: "font-mono text-stone-800 dark:text-stone-200", children: "prompts/one-shot-prompt.md" })] }), _jsx("li", { children: "Add any additional notes to the prompt (tech stack preferences, etc.)" }), _jsx("li", { children: "Copy/paste the prompt into your AI coding agent" }), _jsx("li", { children: "Answer the agent's clarifying questions about auth, user modeling, etc." }), _jsx("li", { children: "Let the agent plan and implement everything" })] }) })] })] })] })] }) }));
}
function ChecklistItem({ label, isComplete }) {
    return (_jsxs("div", { className: "flex items-center gap-2 py-1", children: [isComplete ? (_jsx("div", { className: "w-4 h-4 rounded bg-stone-200 dark:bg-stone-700 flex items-center justify-center", children: _jsx(Check, { className: "w-2.5 h-2.5 text-stone-600 dark:text-stone-400", strokeWidth: 3 }) })) : (_jsx("div", { className: "w-4 h-4 rounded border-2 border-amber-400 dark:border-amber-500" })), _jsx("span", { className: "text-sm text-stone-700 dark:text-stone-300", children: label })] }));
}
function ExportItem({ title, description, items }) {
    return (_jsxs("div", { className: "bg-stone-50 dark:bg-stone-800/50 rounded-lg p-4", children: [_jsx("h4", { className: "font-medium text-stone-900 dark:text-stone-100 mb-1", children: title }), _jsx("p", { className: "text-xs text-stone-500 dark:text-stone-400 mb-3", children: description }), _jsx("ul", { className: "text-sm text-stone-600 dark:text-stone-400 space-y-1", children: items.map((item, index) => (_jsxs("li", { className: "flex items-center gap-2", children: [_jsx("span", { className: "w-1 h-1 rounded-full bg-stone-400 dark:bg-stone-500" }), item] }, index))) })] }));
}
