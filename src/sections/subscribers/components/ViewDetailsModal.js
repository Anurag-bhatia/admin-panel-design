import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState } from 'react';
import { X, Building2, Upload, Trash2, FileText, CreditCard, AlertCircle } from 'lucide-react';
function formatCurrency(amount) {
    return new Intl.NumberFormat('en-IN', {
        style: 'currency',
        currency: 'INR',
        maximumFractionDigits: 0,
    }).format(amount);
}
function formatDate(dateString) {
    return new Date(dateString).toLocaleDateString('en-IN', {
        day: '2-digit',
        month: 'short',
        year: 'numeric',
    });
}
export function ViewDetailsModal({ subscriber, subscription, assignedUser, incidents = [], documents = [], onClose, onEdit, onUploadDocument, onDeleteDocument, onViewIncident }) {
    const [activeTab, setActiveTab] = useState('details');
    const [showDocumentUpload, setShowDocumentUpload] = useState(false);
    const getTabIcon = (tab) => {
        const icons = {
            details: _jsx(Building2, { className: "w-4 h-4" }),
            incidents: _jsx(AlertCircle, { className: "w-4 h-4" }),
            subscription: _jsx(CreditCard, { className: "w-4 h-4" }),
            documents: _jsx(FileText, { className: "w-4 h-4" })
        };
        return icons[tab];
    };
    return (_jsx("div", { className: "fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto", children: _jsxs("div", { className: "bg-white dark:bg-slate-900 rounded-lg shadow-xl max-w-5xl w-full my-8", children: [_jsxs("div", { className: "flex items-center justify-between px-4 sm:px-6 py-3 sm:py-4 border-b border-slate-200 dark:border-slate-800", children: [_jsxs("div", { children: [_jsx("h2", { className: "text-base sm:text-lg lg:text-xl font-bold text-slate-900 dark:text-white", children: subscriber.subscriberName }), _jsx("p", { className: "text-xs text-slate-500 dark:text-slate-400 mt-0.5", children: subscriber.id })] }), _jsx("button", { onClick: onClose, className: "p-1.5 sm:p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors", children: _jsx(X, { className: "w-4 h-4 sm:w-5 sm:h-5 text-slate-500" }) })] }), _jsx("div", { className: "px-4 sm:px-6 pt-4", children: _jsx("div", { className: "flex gap-1 p-1 bg-slate-100 dark:bg-slate-800 rounded-lg w-fit", children: ['details', 'incidents', 'subscription', 'documents'].map((tab) => (_jsxs("button", { onClick: () => setActiveTab(tab), className: `inline-flex items-center gap-2 px-3 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors ${activeTab === tab
                                ? 'bg-white dark:bg-slate-700 text-slate-900 dark:text-white shadow-sm'
                                : 'text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white'}`, children: [getTabIcon(tab), tab.charAt(0).toUpperCase() + tab.slice(1)] }, tab))) }) }), _jsxs("div", { className: "px-4 sm:px-6 py-4 sm:py-6 max-h-[calc(100vh-280px)] overflow-y-auto", children: [activeTab === 'details' && (_jsxs("div", { children: [_jsxs("div", { className: "flex items-center gap-2 mb-6", children: [_jsx("span", { className: `inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${subscriber.status === 'active'
                                                ? 'bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400'
                                                : 'bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400'}`, children: subscriber.status === 'active' ? 'Active' : 'Inactive' }), _jsx("span", { className: "text-xs text-slate-500 dark:text-slate-400", children: subscriber.source })] }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6", children: [_jsxs("div", { children: [_jsx("h3", { className: "text-sm font-semibold text-slate-900 dark:text-slate-50 mb-4", children: "Company Information" }), _jsxs("div", { className: "space-y-3", children: [_jsx(InfoField, { label: "Company Alias", value: subscriber.companyAlias }), _jsx(InfoField, { label: "GST Number", value: subscriber.gstNumber }), _jsx(InfoField, { label: "Type", value: `${subscriber.type} - ${subscriber.subType}` }), _jsx(InfoField, { label: "Fleet Size", value: `${subscriber.numberOfTrucks} Trucks` })] })] }), _jsxs("div", { children: [_jsx("h3", { className: "text-sm font-semibold text-slate-900 dark:text-slate-50 mb-4", children: "Contact Information" }), _jsxs("div", { className: "space-y-3", children: [_jsx(InfoField, { label: "Contact Person", value: subscriber.contactPerson }), _jsx(InfoField, { label: "Email", value: subscriber.emailId }), _jsx(InfoField, { label: "Phone", value: subscriber.phoneNumber }), _jsx(InfoField, { label: "Assigned Owner", value: assignedUser ? assignedUser.fullName : 'Unassigned' })] })] }), _jsxs("div", { className: "md:col-span-2", children: [_jsx("h3", { className: "text-sm font-semibold text-slate-900 dark:text-slate-50 mb-4", children: "Address" }), _jsx("p", { className: "text-sm text-slate-600 dark:text-slate-300", children: subscriber.addressLane }), _jsxs("p", { className: "text-sm text-slate-600 dark:text-slate-300", children: [subscriber.area, ", ", subscriber.city, ", ", subscriber.state, " ", subscriber.pinCode] }), _jsx("p", { className: "text-sm text-slate-600 dark:text-slate-300", children: subscriber.country })] }), _jsxs("div", { className: "md:col-span-2 border-t border-slate-200 dark:border-slate-800 pt-4", children: [_jsx("h3", { className: "text-sm font-semibold text-slate-900 dark:text-slate-50 mb-4", children: "Metadata" }), _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-3 gap-4", children: [_jsx(InfoField, { label: "Created", value: formatDate(subscriber.createdDate) }), _jsx(InfoField, { label: "Last Updated", value: formatDate(subscriber.lastUpdated) }), _jsx(InfoField, { label: "Last Login", value: formatDate(subscriber.lastLogin) })] })] })] })] })), activeTab === 'incidents' && (_jsxs("div", { children: [_jsxs("h3", { className: "text-sm font-semibold text-slate-900 dark:text-slate-50 mb-4", children: ["Linked Incidents (", incidents.length, ")"] }), incidents.length === 0 ? (_jsxs("div", { className: "text-center py-12", children: [_jsx(AlertCircle, { className: "w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-3" }), _jsx("p", { className: "text-sm text-slate-500 dark:text-slate-400", children: "No incidents linked to this subscriber yet" })] })) : (_jsx("div", { className: "overflow-x-auto", children: _jsxs("table", { className: "w-full", children: [_jsx("thead", { children: _jsxs("tr", { className: "border-b border-slate-200 dark:border-slate-800", children: [_jsx("th", { className: "px-3 py-2 text-left text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase", children: "Incident ID" }), _jsx("th", { className: "px-3 py-2 text-left text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase", children: "Vehicle" }), _jsx("th", { className: "px-3 py-2 text-left text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase", children: "Status" }), _jsx("th", { className: "px-3 py-2 text-left text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase", children: "Date" }), _jsx("th", { className: "px-3 py-2 text-left text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase", children: "Actions" })] }) }), _jsx("tbody", { className: "divide-y divide-slate-200 dark:divide-slate-800", children: incidents.map((incident) => (_jsxs("tr", { className: "hover:bg-slate-50 dark:hover:bg-slate-800/50", children: [_jsx("td", { className: "px-3 py-2 text-sm font-medium text-slate-900 dark:text-slate-50", children: incident.id }), _jsx("td", { className: "px-3 py-2 text-sm text-slate-600 dark:text-slate-300", children: incident.vehicleNumber }), _jsx("td", { className: "px-3 py-2", children: _jsx("span", { className: "inline-block px-2 py-1 bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded text-xs font-medium", children: incident.status }) }), _jsx("td", { className: "px-3 py-2 text-sm text-slate-600 dark:text-slate-300", children: formatDate(incident.date) }), _jsx("td", { className: "px-3 py-2", children: _jsx("button", { onClick: () => onViewIncident?.(incident.id), className: "text-xs font-medium text-cyan-600 dark:text-cyan-400 hover:underline", children: "View" }) })] }, incident.id))) })] }) }))] })), activeTab === 'subscription' && (_jsxs("div", { children: [_jsx("h3", { className: "text-sm font-semibold text-slate-900 dark:text-slate-50 mb-6", children: "Subscription Details" }), subscription ? (_jsx("div", { className: "space-y-6", children: _jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6", children: [_jsxs("div", { children: [_jsx("h4", { className: "text-xs font-semibold text-slate-900 dark:text-slate-50 mb-3", children: "Plan Information" }), _jsxs("div", { className: "space-y-3", children: [_jsx(InfoField, { label: "Subscription Name", value: subscription.subscriptionName }), _jsx(InfoField, { label: "Plan Type", value: subscription.planType }), _jsx(InfoField, { label: "Vehicles Covered", value: subscription.vehiclesCount.toString() })] })] }), _jsxs("div", { children: [_jsx("h4", { className: "text-xs font-semibold text-slate-900 dark:text-slate-50 mb-3", children: "Billing Period" }), _jsxs("div", { className: "space-y-3", children: [_jsx(InfoField, { label: "Start Date", value: formatDate(subscription.startDate) }), _jsx(InfoField, { label: "End Date", value: formatDate(subscription.endDate) }), _jsx(InfoField, { label: "Status", value: subscription.subscriptionEnabled ? 'Active' : 'Inactive' })] })] })] }) })) : (_jsxs("div", { className: "text-center py-12", children: [_jsx(CreditCard, { className: "w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-3" }), _jsx("p", { className: "text-sm text-slate-500 dark:text-slate-400", children: "No active subscription" })] }))] })), activeTab === 'documents' && (_jsxs("div", { children: [_jsx("h3", { className: "text-sm font-semibold text-slate-900 dark:text-slate-50 mb-4", children: "Documents" }), showDocumentUpload && (_jsxs("div", { className: "mb-4 p-4 border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-800/50", children: [_jsx("input", { type: "file", onChange: (e) => {
                                                const file = e.target.files?.[0];
                                                if (file) {
                                                    onUploadDocument?.(subscriber.id, file);
                                                    setShowDocumentUpload(false);
                                                }
                                            }, className: "hidden", id: "document-upload" }), _jsxs("label", { htmlFor: "document-upload", className: "flex flex-col items-center cursor-pointer", children: [_jsx(Upload, { className: "w-8 h-8 text-slate-400 mb-2" }), _jsx("p", { className: "text-sm font-medium text-slate-900 dark:text-slate-50", children: "Click to upload a document" }), _jsx("p", { className: "text-xs text-slate-500 dark:text-slate-400", children: "PDF, JPG, PNG up to 10MB" })] })] })), !showDocumentUpload && (_jsxs("button", { onClick: () => setShowDocumentUpload(true), className: "mb-4 inline-flex items-center gap-2 px-3 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-300 rounded-lg text-sm font-medium transition-colors", children: [_jsx(Upload, { className: "w-4 h-4" }), "Upload Document"] })), _jsx("div", { className: "space-y-2", children: documents.length === 0 ? (_jsxs("div", { className: "text-center py-12", children: [_jsx(FileText, { className: "w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-3" }), _jsx("p", { className: "text-sm text-slate-500 dark:text-slate-400", children: "No documents uploaded yet" })] })) : (documents.map((doc) => (_jsxs("div", { className: "flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx(FileText, { className: "w-5 h-5 text-slate-400" }), _jsxs("div", { children: [_jsx("p", { className: "text-sm font-medium text-slate-900 dark:text-slate-50", children: doc.fileName }), _jsxs("p", { className: "text-xs text-slate-500 dark:text-slate-400", children: [doc.category, " \u2022 Uploaded ", formatDate(doc.uploadedDate)] })] })] }), _jsx("button", { onClick: () => onDeleteDocument?.(subscriber.id, doc.id), className: "p-1.5 text-slate-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors", children: _jsx(Trash2, { className: "w-4 h-4" }) })] }, doc.id)))) })] }))] }), _jsxs("div", { className: "flex items-center justify-between gap-3 px-4 sm:px-6 py-3 sm:py-4 border-t border-slate-200 dark:border-slate-800", children: [_jsx("button", { onClick: onClose, className: "px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors", children: "Close" }), _jsx("button", { onClick: () => onEdit(subscriber.id), className: "px-4 py-2 text-sm font-medium text-white bg-cyan-600 rounded-lg hover:bg-cyan-700 transition-colors", children: "Edit Subscriber" })] })] }) }));
}
function InfoField({ label, value }) {
    return (_jsxs("div", { children: [_jsx("p", { className: "text-xs text-slate-500 dark:text-slate-400 font-medium mb-1", children: label }), _jsx("p", { className: "text-sm text-slate-900 dark:text-slate-50", children: value })] }));
}
